Emmet.prototype.create=function(b){try{this.build();this.data.setData(b);var a=this.tree.getHtml();this.tree.drop();return a}catch(c){this.throwError(c.message)}};Emmet.prototype.build=function(){try{var h="root>"+this.getEmmet(),c=new PN(),f=new FSM(),b=new Node(this.data),k="",g=0,a=h.length-1,d="",l=null;b.setType("root");while("end"!==f.state){if(g>a){d=""}else{d=h.charAt(g)}if("/"===d){if(g===a){g++;continue}else{k+=h[++g];++g;continue}}if("error"===f.state){throw new Error("There was an error in your Emmet string. "+this.getCheckTheDocumentation(g))}f.setState(d);if(f.is_state_changed){switch(f.prev_state){case"operator":l=h[g-2];if((l!=="^"&&l!==")")&&"("!==k){c.setOperand(b);b=new Node(this.data)}c.setOperator(k);break;case"tag":b.addValueToTag(k,"text");break;case"tag_var":b.addValueToTag(k,"var");break;case"tag_func":if("tag"!==f.state){b.addValueToTag(k,"func")}break;case"tag_args":break;case"tag_arg_txt":b.addValueToTag(k,"arg_txt");break;case"tag_arg_var":b.addValueToTag(k,"arg_var");break;case"id":b.addValueToId(k,"text");break;case"id_var":b.addValueToId(k,"var");break;case"id_func":if("id"!==f.state){b.addValueToId(k,"func")}break;case"id_args":break;case"id_arg_txt":b.addValueToId(k,"arg_txt");break;case"id_arg_var":b.addValueToId(k,"arg_var");break;case"class_name":b.addValueToClass(k,"text");break;case"class_name_var":b.addValueToClass(k,"var");break;case"class_name_func":if("class_name"!==f.state){b.addValueToClass(k,"func")}break;case"class_name_args":break;case"class_name_arg_txt":b.addValueToClass(k,"arg_txt");break;case"class_name_arg_var":b.addValueToClass(k,"arg_var");break;case"attr":b.addValueToAttributes(k,"text");break;case"attr_var":b.addValueToAttributes(k,"var");break;case"attr_func":if("attr"!==f.state){b.addValueToAttributes(k,"func")}break;case"attr_args":break;case"attr_arg_txt":b.addValueToAttributes(k,"attr_txt");break;case"attr_arg_var":b.addValueToAttributes(k,"attr_var");break;case"after_attr":break;case"text":b.addValueToValue(k,"text");break;case"text_var":b.addValueToValue(k,"var");break;case"text_func":if("text"!==f.state){b.addValueToValue(k,"func")}break;case"text_args":break;case"text_arg_txt":b.addValueToValue(k,"arg_txt");break;case"text_arg_var":b.addValueToValue(k,"arg_var");break;case"after_text":break;case"text_node":b.addValueToValue(k,"text");break;case"text_node_var":b.addValueToValue(k,"var");break;case"text_node_func":if("text_node"!==f.state){b.addValueToValue(k,"func")}break;case"text_node_args":break;case"text_node_arg_txt":b.addValueToValue(k,"arg_txt");break;case"text_node_arg_var":b.addValueToValue(k,"arg_var");break;case"after_text_node":b.setType("text_node");break;case"multi":b.addValueToMultiplication(k,"text");break;case"multi_var":b.addValueToMultiplication(k,"var");break;case"multi_func":if("multi"!==f.state){b.addValueToMultiplication(k,"func")}break;case"multi_args":break;case"multi_arg_txt":b.addValueToMultiplication(k,"arg_txt");break;case"multi_arg_var":b.addValueToMultiplication(k,"arg_var");break;case"html":b.setType("html");break;case"html_var":b.addValueToValue(k,"var");break;case"html_func":if("html"!==f.state){b.addValueToValue(k,"func")}break;case"html_args":break;case"html_arg_txt":b.addValueToValue(k,"arg_txt");break;case"html_arg_var":b.addValueToValue(k,"arg_var");break;default:throw new Error("Unhandled Finite State Machine State. "+this.getCheckTheDocumentation(g));break}if(("operator"===f.state||"tag"===f.state||"html_arg_txt"===f.state||"text_arg_txt"===f.state||"text_node_arg_txt"===f.state||"tag_arg_txt"===f.state||"id_arg_txt"===f.state||"class_name_arg_txt"===f.state||"attr_arg_txt"===f.state||"multi_arg_txt"===f.state)&&("`"!==d&&"%"!==d)){k=d}else{k=""}}else{if("skip"!==f.state){k+=d}}++g}if("end"===f.state&&"operator"!==f.prev_state){c.setOperand(b)}this.tree=c.generateTree();if(!(this.tree instanceof Node)){throw new Error(tree)}delete c;delete f}catch(j){this.throwError(j.message,j.lineNumber,j.fileName)}};Emmet.prototype.throwError=function(b,a,c){console.log("Emmet Error: "+b+" File: "+c+" Line Number: "+a+".");this.error=true};Emmet.prototype.getCheckTheDocumentation=function(a){a-=6;return'Check the documentation for the right syntax to use near "'+this.getEmmet().substr(a)+'".'};function Data(){this.data={}}Data.prototype.setData=function(a){this.data=a};Data.prototype.get=function(f,e,b){if("$"===f){if(undefined!==this.data[e]){return this.data[e]}return e}f+=";";var g=this.data,a=".",j="",d="";for(var h=0,c=f.length;h<c;++h){d=f.charAt(h);if("$"===d){d=e}if((("["===d||"]"===d||"{"===d||"}"===d||"."===d||";"===d))){if(""!==j){if(a==="."){if(undefined!==g[j]){g=g[j]}else{throw new Error("Cann't find the variable \""+f.substr(0,c-1)+'".')}}else{if("{"===a){if(undefined!==g[j]){g=g[j]}else{throw new Error("Cann't find the variable \""+f.substr(0,c-1)+'".')}}else{if(undefined!==g[j]){g=g[j]}else{throw new Error("Cann't find the variable \""+f.substr(0,c-1)+'".')}}}}j="";a=d;continue}else{j+=d}}if(undefined!==b&&"string"===typeof g){g=g.replace(/\{\{value\}\}/gi,b)}return g};Data.prototype.func=function(c,b,f,e){var a=[];if("function"===typeof window[c]){for(var d in b){if("var"===b[d].type){a[a.length]=this.get(b[d].value,e,null)}else{a[a.length]=b[d].value}}if(f){a[a.length]=f}return window[c].apply(this,a)}else{throw new Error('Function "'+c+"\" doesn't exists.")}};function FSM(){var b={operator:{"+":"operator",">":"operator","^":"operator","(":"operator",")":"operator",a:"tag","#":"id",".":"class_name","[":"attr","]":"error","{":"text_node","}":"error","*":"multi","`":"html_var","%":"html_func"," ":"skip","":"end",",":"error"},tag:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"same","#":"id",".":"class_name","[":"attr","]":"error","{":"text","}":"error","*":"multi","`":"tag_var","%":"tag_func"," ":"skip","":"end",",":"error"},tag_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"tag","%":"error"," ":"error","":"error",",":"error"},tag_func:{"+":"error",">":"error","^":"error","(":"tag_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"tag"," ":"skip","":"error",",":"error"},tag_args:{"+":"error",">":"error","^":"error","(":"error",")":"tag_func",a:"tag_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"tag_arg_var","%":"error"," ":"skip","":"error",",":"skip"},tag_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"tag_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"tag_args"},tag_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"tag_args","%":"error"," ":"error","":"error",",":"error"},id:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"same","#":"error",".":"class_name","[":"attr","]":"error","{":"text","}":"error","*":"multi","`":"id_var","%":"id_func"," ":"skip","":"end",",":"error"},id_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"id","%":"error"," ":"error","":"error",",":"error"},id_func:{"+":"error",">":"error","^":"error","(":"id_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"id"," ":"skip","":"error",",":"error"},id_args:{"+":"error",">":"error","^":"error","(":"error",")":"id_func",a:"id_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"id_arg_var","%":"error"," ":"skip","":"error",",":"skip"},id_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"id_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"id_args"},id_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"id_args","%":"error"," ":"error","":"error",",":"error"},class_name:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"same","#":"error",".":"class_name","[":"attr","]":"error","{":"text","}":"error","*":"multi","`":"class_name_var","%":"class_name_func"," ":"same","":"end",",":"error"},class_name_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"class_name","%":"error"," ":"error","":"error",",":"error"},class_name_func:{"+":"error",">":"error","^":"error","(":"class_name_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"class_name"," ":"skip","":"error",",":"error"},class_name_args:{"+":"error",">":"error","^":"error","(":"error",")":"class_name_func",a:"class_name_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"class_name_arg_var","%":"error"," ":"skip","":"error",",":"skip"},class_name_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"class_name_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"class_name_args"},class_name_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"class_name_args","%":"error"," ":"error","":"error",",":"error"},attr:{"+":"same",">":"same","^":"same","(":"same",")":"same",a:"same","#":"same",".":"same","[":"error","]":"after_attr","{":"same","}":"same","*":"same","`":"attr_var","%":"attr_func"," ":"same","":"error",",":"same"},attr_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"attr","%":"error"," ":"error","":"error",",":"error"},attr_func:{"+":"error",">":"error","^":"error","(":"attr_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"attr"," ":"skip","":"error",",":"error"},attr_args:{"+":"error",">":"error","^":"error","(":"error",")":"attr_func",a:"attr_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"attr_arg_var","%":"error"," ":"skip","":"error",",":"skip"},attr_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"attr_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"attr_args"},attr_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"attr_args","%":"error"," ":"error","":"error",",":"error"},after_attr:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"error","#":"error",".":"error","[":"error","]":"error","{":"text","}":"error","*":"multi","`":"error","%":"error"," ":"skip","":"end",",":"error"},text:{"+":"same",">":"same","^":"same","(":"same",")":"same",a:"same","#":"same",".":"same","[":"same","]":"same","{":"error","}":"after_text","*":"same","`":"text_var","%":"text_func"," ":"same","":"error",",":"same"},text_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"text","%":"error"," ":"error","":"error",",":"error"},text_func:{"+":"error",">":"error","^":"error","(":"text_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"text"," ":"skip","":"error",",":"error"},text_args:{"+":"error",">":"error","^":"error","(":"error",")":"text_func",a:"text_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"text_arg_var","%":"error"," ":"skip","":"error",",":"skip"},text_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"text_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"text_args"},text_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"text_args","%":"error"," ":"error","":"error",",":"error"},after_text:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"error","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"multi","`":"error","%":"error"," ":"skip","":"end",",":"error"},text_node:{"+":"same",">":"same","^":"same","(":"same",")":"same",a:"same","#":"same",".":"same","[":"same","]":"same","{":"error","}":"after_text_node","*":"same","`":"text_node_var","%":"text_node_func"," ":"same","":"error",",":"same"},text_node_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"text_node","%":"error"," ":"error","":"error",",":"error"},text_node_func:{"+":"error",">":"error","^":"error","(":"text_node_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"text_node"," ":"skip","":"error",",":"error"},text_node_args:{"+":"error",">":"error","^":"error","(":"error",")":"text_node_func",a:"text_node_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"text_node_arg_var","%":"error"," ":"skip","":"error",",":"skip"},text_node_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"text_node_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"text_node_args"},text_node_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"text_node_args","%":"error"," ":"error","":"error",",":"error"},after_text_node:{"+":"operator",">":"error","^":"operator","(":"error",")":"operator",a:"error","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"multi","`":"error","%":"error"," ":"skip","":"end",",":"error"},multi:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"multi_var","%":"multi_func"," ":"same","":"end",",":"error"},multi_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"multi","%":"error"," ":"error","":"error",",":"error"},multi_func:{"+":"error",">":"error","^":"error","(":"multi_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"multi"," ":"skip","":"error",",":"error"},multi_args:{"+":"error",">":"error","^":"error","(":"error",")":"multi_func",a:"multi_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"multi_arg_var","%":"error"," ":"skip","":"error",",":"skip"},multi_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"multi_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"multi_args"},multi_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"multi_args","%":"error"," ":"error","":"error",",":"error"},error:{},end:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"error","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"error","":"error",",":"error"},html:{"+":"operator",">":"operator","^":"operator","(":"error",")":"operator",a:"error","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"multi","`":"error","%":"error"," ":"skip","":"end",",":"error"},html_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"html","%":"error"," ":"error","":"error",",":"error"},html_func:{"+":"error",">":"error","^":"error","(":"html_args",")":"error",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"html"," ":"skip","":"error",",":"error"},html_args:{"+":"error",">":"error","^":"error","(":"error",")":"html_func",a:"html_arg_txt","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"html_arg_var","%":"error"," ":"skip","":"error",",":"skip"},html_arg_txt:{"+":"error",">":"error","^":"error","(":"error",")":"html_func",a:"same","#":"error",".":"error","[":"error","]":"error","{":"error","}":"error","*":"error","`":"error","%":"error"," ":"same","":"error",",":"html_args"},html_arg_var:{"+":"error",">":"error","^":"error","(":"error",")":"error",a:"same","#":"error",".":"same","[":"same","]":"same","{":"same","}":"same","*":"error","`":"html_args","%":"error"," ":"error","":"error",",":"error"}};this.prev_state=this.state="tag";this.is_state_changed=true;var a=["+",">","^","(",")","a","#",".","[","]","{","}","*","`","%"," ","",","];this.setState=function(e){var c="",d=null;if("error"===this.state){throw new Error("Finite State Machine Error.")}if(-1===a.indexOf(e)){c="a"}else{c=e}d=b&&b[this.state]&&b[this.state][c];this.is_state_changed=false;switch(d){case"same":break;case"skip":break;default:this.prev_state=this.state;this.is_state_changed=true;this.state=d;break}return true}}function Tree(){this.first_child=null;this.right_sibling=null;this.parent=null;this.is_root=false}Tree.prototype.addTo=function(a){if(!(a instanceof Tree)){throw new Error("Tree::addTo. Parent is not a Tree.")}if(this.is_root){throw new Error("You cann't add a root node to another node.")}if(this.parent){this.parent.addTo(a)}else{this.parent=a;if(null===a.first_child){a.first_child=this}else{var b=a.first_child;while(null!==b.right_sibling){b=b.right_sibling}b.right_sibling=this}}};Tree.prototype.addSibling=function(a){if(!(a instanceof Tree)){throw new Error("Tree::addSibling. Sibling is not a Tree.")}if(null!==this.right_sibling){return this.right_sibling.addSibling(a)}a.parent=this.parent;this.right_sibling=a;return true};Tree.prototype.hasParent=function(){return Boolean(this.parent)};Tree.prototype.setRoot=function(){this.is_root=true};Tree.prototype.drop=function(){if(this.first_child){this.first_child.drop();this.first_child=null}if(this.right_sibling){this.right_sibling.drop();this.right_sibling=null}};function Node(b){this.type="tag";this.tag=[];this.attributes=[];this.id=[];this.class_name=[];this.value=[];this.multiplication=[];this.number=0;if(b instanceof Data){this.data=b}else{throw new Error("Node::construct() data is not a Data.")}var a="%hr%br%input%link%meta%img%";this.getSelfClosingTags=function(){return a};Tree.apply(this,arguments)}Node.prototype=Object.create(Tree.prototype);Node.prototype.constructor=Node;Node.prototype.setType=function(a){if("tag"===a||"text_node"===a||"html"===a){this.type=a}else{if("root"===a){this.type="root";this.setRoot()}else{throw new Error('Node::setType(). Undefined type of Node. Use "tag", "text_node", "html".')}}};Node.prototype.createValue=function(a,d,b){switch(b){case"text":a[a.length]={type:"text",value:d};break;case"func":a[a.length]={type:"func",name:d,args:[]};break;case"var":a[a.length]={type:"var",name:d};break;default:if(0===a.length||"func"!==a[a.length-1].type){throw new Error("Node::createValue(). Wrong type of added value - "+b+".")}var c=a[a.length-1];if("arg_var"===b){c.args[c.args.length]={type:"var",value:d}}else{if("arg_txt"===b){c.args[c.args.length]={type:"text",value:d}}else{throw new Error("Node::createValue(). Wrong type of added value - "+b+".")}}break}return true};Node.prototype.addValueToTag=function(b,a){this.createValue(this.tag,b,a)};Node.prototype.addValueToAttributes=function(b,a){this.createValue(this.attributes,b,a)};Node.prototype.addValueToId=function(b,a){this.createValue(this.id,b,a)};Node.prototype.addValueToClass=function(b,a){this.createValue(this.class_name,b,a)};Node.prototype.addValueToValue=function(b,a){this.createValue(this.value,b,a)};Node.prototype.addValueToMultiplication=function(b,a){this.createValue(this.multiplication,b,a)};Node.prototype.getHtml=function(a){a=parseInt(a);this.number=a;if("tag"===this.type){return this.getHtmlForTag(a)}else{if("html"===this.type){return this.getHtmlForHtml(a)}else{if("text_node"===this.type){return this.getHtmlForTextNode(a)}else{if("root"===this.type){return this.getHtmlForRoot()}else{return""}}}}};Node.prototype.getHtmlForRoot=function(){if(null!==this.first_child){return this.first_child.getHtml(0)}};Node.prototype.getHtmlForTag=function(d){var b="",e=this.get("multiplication"),a=this.get("tag");for(var c=0;c<e;c++){if(1<e){this.setNumber(c)}if(-1!==this.getSelfClosingTags().indexOf("%"+a+"%")){b+=this.selfClosingElement(a)}else{if(null!==this.first_child){b+=this.closingElement(a,this.get("value")+this.first_child.getHtml(this.number))}else{b+=this.closingElement(a,this.get("value"))}}}if(this.right_sibling){b+=this.right_sibling.getHtml(d)}return b};Node.prototype.getHtmlForHtml=function(c){var a="",e=this.get("multiplication");for(var b=0;b<e;++b){if(1<e){this.setNumber(b)}var d="";if(this.first_child){this.first_child.setNumber(b);d+=this.first_child.getHtml(this.number)}a+=this.get("value",d)}if(this.right_sibling){a+=this.right_sibling.getHtml(c)}return a};Node.prototype.getHtmlForTextNode=function(c){var a="",d=this.get("multiplication");for(var b=0;b<d;++b){if(1<d){this.setNumber(b)}a+=this.get("value")}if(this.right_sibling){return a+this.right_sibling.getHtml(c)}return a};Node.prototype.get=function(a,e){if("multiplication"===a&&0===this.multiplication.length){return 1}if(undefined!==this[a]){var c="",d=this[a];for(var b in d){switch(this[a][b].type){case"text":c+=this[a][b].value;break;case"var":c+=this.data.get(this[a][b].name,this.number,e);break;case"func":c+=this.data.func(this[a][b].name,this[a][b].args,e,this.number);break;default:c+="";break}}return c}return""};Node.prototype.selfClosingElement=function(a){return"<"+a+this.getAttributes()+" />"};Node.prototype.closingElement=function(a,b){return"<"+a+this.getAttributes()+">"+b+"</"+a+">"};Node.prototype.setNumber=function(a){this.number=parseInt(a)};Node.prototype.getAttributes=function(){var b={},h=this.get("id"),f=this.get("class_name"),g=(this.get("attributes")).split(" "),a="",c="";if(h){b.id=h}if(f){b["class"]=f}for(var e in g){a=g[e].split("=");if("class"===a[0]){if(undefined!==b["class"]){b["class"]+=" "+((undefined!==a[1])?a[1]:"")}else{b["class"]=((undefined!==a[1])?a[1]:"")}}else{if(""===a[0]){continue}else{b[a[0]]=(undefined!==a[1])?a[1]:a[0]}}}for(var d in b){c+=" "+d+'="'+b[d]+'"'}return c};function PN(){this.output=[];this.stack=[]}PN.prototype.setOperand=function(a){if(!(a instanceof Node)){throw new Error("PN::setOperand() operand must be a Node.")}this.output.push(a)};PN.prototype.setOperator=function(b){switch(b){case"(":this.stack.push("(");return true;case")":b=null;var a=-2;do{if(null!==b){this.output[this.output.length]=b}b=this.stack.pop();if(">"===b){a++}if(undefined===b){throw new Error("Incorrectly placed brackets.")}}while("("!==b);while(a>0){this.output[this.output.length]="^";a--}return true;case"+":this.stack.push("+");return true;case">":this.stack.push(">");return true;case"^":do{b=this.stack.pop();if(0===this.stack.length){throw new Error('The "^" operator is excess.')}this.output[this.output.length]=b}while(">"!==b);this.output[this.output.length]="^";return true;default:throw new Error('Undefined operator "'+b+'".')}};PN.prototype.endOutput=function(){var a=null;while(true){a=this.stack.pop();if(undefined===a){break}else{if("("===a){throw new Error("Incorrectly placed brackets.")}else{this.output[this.output.length]=a}}}return this.output};PN.prototype.generateTree=function(){this.endOutput();var d=null;var b=null;var e=null;var f=null;var c=null;while(0!==this.output.length){d=this.output.shift();if(d instanceof Node){this.stack.push(d)}else{if(">"===d){f=this.stack.pop();c=this.stack.pop();if(c instanceof Node&&f instanceof Node){f.addTo(c);this.stack.push(c)}else{throw new Error("The number of operands less than operations.")}}else{if("+"===d){b=this.stack.pop();e=this.stack.pop();if(e instanceof Node&&b instanceof Node){e.addSibling(b);this.stack.push(e)}else{throw new Error("The number of operands less than operations.")}}else{if("^"===d){f=this.stack.pop();if(f instanceof Node){c=f.parent;if(null!==c){this.stack.push(c)}else{if(!f.is_root){this.stack.push(f)}else{throw new Error('You are out of the tree. Check "^" operator.')}}}else{throw new Error("The number of operands less than operations.")}}else{throw new Error('Undefined Operation. "'+d+'".')}}}}}var a=this.stack.pop();while(null!==a.parent){a=a.parent}return a};